var seoify=function(){return{root_url:null,active_state:null,available_states:[],isloaded:!1,init:function(){var self=this;this.root_url=History.getRootUrl(),this.active_state=History.getState().hash,History.options.html4Mode=!0,History.Adapter.bind(window,"statechange",function(){self.active_state=History.getState().hash,console.log("History.binder",self.active_state)}),this.setup()},setup:function(){var self=this,seoifyElements=$("body *[data-seoify]");console.log("setup",seoifyElements),$(seoifyElements).each(function(){var element=$(this),title=$(this).attr("data-title"),urlslug="#/"+$(this).attr("data-seoify"),callback=self.setpushState;self.store(urlslug,element),self.watch(element,callback,urlslug,title)})},store:function(urlslug,element){if(!this.isloaded){var init_hash=History.getState().hash;console.warn("is loaded",init_hash,init_hash==urlslug),init_hash==urlslug&&(console.warn("slug match",element),this.scrolltoElement(element),this.isloaded=!0)}this.available_states.push(urlslug)},watch:function(element,callback,urlslug,title){$(window).scroll(function(){var offset=$(element).offset(),eltop=offset.top,eltoprange=offset.top-$(window).height()/4,elbottom=eltop+$(element).outerHeight(),scrolltop=$(window).scrollTop(),viewtop=$(window).scrollTop()+$(window).height()/4,viewbottom=$(window).scrollTop()+$(window).height();if("First feature title"==title&&console.log("offset",element.attr("data-seoify"),"eltop: "+eltop,"viewtop: "+viewtop,"scrolltop: "+$(window).scrollTop(),eltop==viewtop),scrolltop>eltoprange&&viewtop>scrolltop&&console.warn("pos check",title),viewbottom>eltop&&elbottom>viewbottom){clearTimeout(seoify_eventBuffer);var seoify_eventBuffer=setTimeout(callback(urlslug,title),1e3)}})},setpushState:function(slug,title){this.active_state!=slug&&(this.active_state=slug,History.pushState(null,title,slug),console.log("setPushState",slug,this.active_state))},scrolltoElement:function(element){$(element).ScrollTo()}}}(seoify);seoify.init();